tinymce.PluginManager.add("smileys",function(t,e){function l(){var t;return t='<table role="presentation" class="mce-grid">',tinymce.each(a,function(e){t+="<tr>",tinymce.each(e,function(e){t+='<td><a href="#" data-emoticon="'+e.url+'"><span class="emoticon '+e.url+'"></span></a></td>'}),t+="</tr>"}),t+="</table>"}function i(t){var e=tinymce.each,l=[];return e(t,function(t){l=l.concat(t)}),l.length>0?l:t}function r(t,e,l,i,r){function n(t,e){e=e||0;var l=t.index;if(e>0){var i=t[e];l+=t[0].indexOf(i),t[0]=i}return[l,l+t[0].length,[t[0]]]}function u(t){var e;if(3===t.nodeType)return t.data;if(h[t.nodeName]&&!g[t.nodeName])return"";if(e="",(g[t.nodeName]||p[t.nodeName])&&(e+="\n"),t=t.firstChild)do e+=u(t);while(t=t.nextSibling);return e}function o(t,e,l){var i,r,n,u,o=[],a=0,s=t,d=e.shift(),c=0;t:for(;;){if((g[s.nodeName]||p[s.nodeName])&&a++,3===s.nodeType&&(!r&&s.length+a>=d[1]?(r=s,u=d[1]-a):i&&o.push(s),!i&&s.length+a>d[0]&&(i=s,n=d[0]-a),a+=s.length),i&&r){if(s=l({startNode:i,startNodeIndex:n,endNode:r,endNodeIndex:u,innerNodes:o,match:d[2],matchIndex:c}),a-=r.length-u,i=null,r=null,o=[],d=e.shift(),c++,!d)break}else{if((!h[s.nodeName]||g[s.nodeName])&&s.firstChild){s=s.firstChild;continue}if(s.nextSibling){s=s.nextSibling;continue}}for(;;){if(s.nextSibling){s=s.nextSibling;break}if(s.parentNode===t)break t;s=s.parentNode}}}function a(t){var e;if("function"!=typeof t){var l=t.nodeType?t:f.createElement(t);e=function(){var t=l.cloneNode(!1);return t}}else e=t;return function i(t){var l,i,r,n=t.startNode,u=t.endNode;if(n===u){var o=n;r=o.parentNode,t.startNodeIndex>0&&(l=f.createTextNode(o.data.substring(0,t.startNodeIndex)),r.insertBefore(l,o));var a=e();return r.insertBefore(a,o),t.endNodeIndex<o.length&&(i=f.createTextNode(o.data.substring(t.endNodeIndex)),r.insertBefore(i,o)),o.parentNode.removeChild(o),a}}}var s,d=[],c,m=0,f,g,h,p;if(f=e.ownerDocument,g=r.getBlockElements(),h=r.getWhiteSpaceElements(),p=r.getShortEndedElements(),c=u(e)){for(;s=t.exec(c);)d.push(n(s,i));return d.length&&(m=d.length,o(e,d,a(l))),m}}function n(e){var l=tinymce.each,i=t.selection.getNode(),n,u;return"string"==typeof e.shortcut?(u=e.shortcut.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n=t.dom.create("img",{src:e.url,title:e.title}),r(new RegExp(u,"gi"),i,n,!1,t.schema)):void(Array.isArray(e.shortcut)&&l(e.shortcut,function(l){return n=t.dom.create("img",{src:e.url,title:e.title}),r(new RegExp(l.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gi"),i,n,!1,t.schema)}))}var u=[[{url:"cool",title:""},{url:"happy1",title:""},{url:"happy2",title:""},{url:"happy3",title:""},{url:"happy4",title:""},{url:"wink",title:""},{url:"sad",title:""},{url:"crying",title:""},{url:"notimpressed",title:""},{url:"omg",title:""}],[{url:"woah",title:""},{url:"tongue",title:""},{url:"sweating",title:""},{url:"angel",title:""},{url:"inlove",title:""},{url:"heart",title:""},{url:"unknown",title:""},{url:"workbench",title:""},{url:"furnace",title:""},{url:"coal",title:""}],[{url:"grass",title:""},{url:"dirt",title:""},{url:"cobblestone",title:""},{url:"stone",title:""},{url:"diamond",title:""},{url:"diamondpickaxe",title:""},{url:"diamondshovel",title:""},{url:"diamondaxe",title:""},{url:"diamondsword",title:""},{url:"gold",title:""}],[{url:"wood",title:""},{url:"woodslab",title:""},{url:"sand",title:""},{url:"nether",title:""},{url:"iron",title:""},{url:"ironpickaxe",title:""},{url:"ironshovel",title:""},{url:"ironaxe",title:""},{url:"ironsword",title:""},{url:"goldapple",title:""}],[{url:"chicken",title:""},{url:"steak",title:""},{url:"pork",title:""},{url:"fish",title:""},{url:"bread",title:""},{url:"cake",title:""},{url:"cookie",title:""},{url:"wheat",title:""},{url:"melon",title:""},{url:"apple",title:""}],[{url:"bucket",title:""},{url:"bucketwater",title:""},{url:"bucketlava",title:""},{url:"bucketmilk",title:""},{url:"waterbottle",title:""},{url:"pumpkin",title:""},{url:"sugar",title:""},{url:"sugarcane",title:""},{url:"paper",title:""},{url:"painting",title:""}],[{url:"musicdisk1",title:""},{url:"musicdisk2",title:""},{url:"musicdisk3",title:""},{url:"musicdisk4",title:""},{url:"musicdisk5",title:""},{url:"chest",title:""},{url:"tnt",title:""},{url:"compass",title:""},{url:"map",title:""},{url:"sign",title:""}],[{url:"minecart",title:""},{url:"boat",title:""},{url:"fishingrod",title:""},{url:"bed",title:""},{url:"flint",title:""},{url:"lapislazuli",title:""},{url:"redstone",title:""},{url:"slime",title:""},{url:"snow",title:""},{url:"bone",title:""}]],o=t.settings.smileys||u,a=t.settings.extended_smileys?o.concat(t.settings.extended_smileys):o;t.on("keyup",function(e){if(t.settings.auto_convert_smileys){var l=tinymce.each,r=t.selection,u=r.getNode();u&&l(i(a),function(t){n(t)})}}),t.addButton("smileys",{type:"panelbutton",icon:"emoticons",panel:{autohide:!0,html:l,onclick:function(e){var l=t.dom.getParent(e.target,"a");l&&(t.insertContent('<span class="emoticon '+l.getAttribute("data-emoticon")+' mceNonEditable" data-mce-contenteditable="false">&nbsp;</span>'),this.hide())}},tooltip:"Smileys"})});