$(function(){tinymce.init({selector:"textarea.tinymce-submission",height:"200px",theme:"modern",skin:"lightgray",menubar:!1,statusbar:!1,paste_as_text:!0,object_resizing:!1,plugins:["link paste hr smileys noneditable autolink placeholder"],toolbar:"bold underline italic | smileys | link hr | bullist numlist | undo redo",setup:function(e){e.on("change",function(){tinyMCE.triggerSave(),$("#"+e.id).valid(),$(".mce-tinymce").removeClass("error"),$("#"+e.id+"-error").length&&$("#"+e.id+"-error").fadeOut(300)})}});var e=0,r=[];dropzone.on("success",function(i,t){e++;var s=$.parseJSON(t).msg;r.push(s),dropzone.getAcceptedFiles().length===e&&($("#submission input#uploaded").val(JSON.stringify(r)),$("#submission")[0].submit())}),$("#submission").submit(function(e){e.preventDefault(),$(".dz-error .alert").remove(),dropzone.getAcceptedFiles().length?$("#submission").valid()&&($(".file .progress").fadeIn(200),dropzone.enqueueFiles(dropzone.getFilesWithStatus(Dropzone.ADDED))):0===$(".dropzone .dz-message .alert").length&&$(".dropzone .dz-message").append('<div class="alert">You must upload at least one screenshot with your post.</div>')});var i=$("#submission").validate({ignore:"",rules:{title:{required:!0,maxlength:70},description:{required:!0},link:{required:!0,url:!0},category:{required:!0},version:{required:!0},device:{required:!0},seed:{required:!0},resolution:{required:!0},ip:{required:!0},port:{required:!0}},messages:{title:{required:"Enter a title",maxlength:"Title can't be longer than 70 characters"},description:{required:"Enter a description"},link:{required:"Enter a download link",url:"This URL isn't valid"},category:{required:"Select a category"},version:{required:"Select a version"},device:{required:"Select a platform"},seed:{required:"Enter the seed code"},resolution:{required:"Select texture resolution"},ip:{required:"Enter server IP address"},port:{required:"Enter server port"}},errorPlacement:function(e,r){r.is("textarea")?(e.insertAfter(r).hide().fadeIn(300),$(".mce-tinymce").addClass("error")):r.hasClass("selectize")?(r.next(".selectize-control").addClass("error"),e.insertAfter(r.next(".selectize-control")).hide().fadeIn(300)):e.insertAfter(r).hide().fadeIn(300)}});i.focusInvalid=function(){if(this.settings.focusInvalid)try{var e=$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]);e.is("textarea")?tinyMCE.get(e.attr("id")).focus():e.filter(":visible").focus()}catch(r){}}});